<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Rw7</title>
    <link rel="stylesheet" href="chat-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body>
    <div class="iphone">
        <div class="notch">
            <div class="camera"></div>
            <div class="speaker"></div>
        </div>
        <div class="screen">
            <div class="chat-header">
                <div class="back-button" onclick="goBack()">
                    <i class="fas fa-chevron-right"></i>
                </div>
                <div class="user-info">
                    <h3>Chat Rw7</h3>
                    <span class="status">Ù…ØªØµÙ„ Ø§Ù„Ø¢Ù†</span>
                </div>
            </div>
            
            <div class="messages" id="messages">
                <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø³ØªØ¶Ø§Ù Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
            </div>
            
            <div class="input-area">
                <button class="send-button" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
                <input type="text" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...">
            </div>
        </div>
    </div>

    <script>
        let chatResetTimer;

        function resetChat() {
            const messagesDiv = document.getElementById('messages');
            messagesDiv.innerHTML = ''; // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
            
            // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ù…Ù† Ø¬Ø¯ÙŠØ¯
            setTimeout(() => {
                addMessage("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Chat Rw7! ğŸ‘‹", 'received');
            }, 500);
        }

        function startChatResetTimer() {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ ÙˆØ¬Ø¯
            if (chatResetTimer) {
                clearTimeout(chatResetTimer);
            }
            // ØªØ¹ÙŠÙŠÙ† Ù…Ø¤Ù‚Øª Ø¬Ø¯ÙŠØ¯ (60000 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© = Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©)
            chatResetTimer = setTimeout(resetChat, 60000);
        }

        function addMessage(text, type) {
            const messagesDiv = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const time = new Date();
            const timeStr = `${time.getHours()}:${time.getMinutes().toString().padStart(2, '0')}`;
            
            messageDiv.innerHTML = `
                <p>${text}</p>
                <span class="time">${timeStr}</span>
            `;
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
            startChatResetTimer();
        }

        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (text) {
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Firebase
                database.ref('messages').push({
                    text: text,
                    timestamp: Date.now(),
                    userId: 'user123' // ÙŠØ¬Ø¨ ØªØºÙŠÙŠØ±Ù‡ Ø¨Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
                });
                
                input.value = '';
            }
        }

        function goBack() {
            window.location.href = 'iphone.html';
        }

        // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø´Ø§Øª ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
        window.onload = function() {
            setTimeout(() => {
                addMessage("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Chat Rw7! ğŸ‘‹", 'received');
            }, 500);
            startChatResetTimer();
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¶ØºØ· Enter
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // ØªÙ‡ÙŠØ¦Ø© Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBzsQ_TekHdWbe8mM2u4lsvboTPtxBKiSU",
            authDomain: "chatrw7.firebaseapp.com",
            projectId: "chatrw7",
            storageBucket: "chatrw7.firebasestorage.app",
            messagingSenderId: "6083920767",
            appId: "1:6083920767:web:ac25161ac71fd521d1504a",
            measurementId: "G-ZQXJZ5JBNJ"
        };

        // ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        database.ref('messages').on('child_added', (snapshot) => {
            const message = snapshot.val();
            addMessage(message.text, 'sent');
        });
    </script>
</body>
</html> 